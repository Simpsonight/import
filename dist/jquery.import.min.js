(function(t){t.import=function(e,n,r){var o={loading:0,lengthLoading:0,loaded:0,$body:t("body"),$doc:t(document),promise:t.Deferred(),viewport:window.innerHeight};return o.getDependencies=function(r){var i,u,a=t(),s={};if(0===r.fetch.length){if(r.condition.jquery&&(a=r.condition),r.callback)for(var c=0,l=r.callback.length;l>c;c+=1)r.callback[c].method&&(r.callback[c].param?r.callback[c].method.call(a,r.callback[c].param):r.callback[c].method.call(a));if(r.event&&r.event.length)for(var f=0,d=r.event.length;d>f;f+=1)u=r.event[f].data.slice()||[],o.$doc.trigger(r.event[f].name,u);return a.is("body")||a.removeClass("on-loading"),o.$doc.trigger("on-module-loaded"),o.loaded+=1,n&&o.setStatus(),e.shift(),o.loading-=1,e[0]&&o.getDependencies(e[0]),void 0}s.url=r.fetch[0],r.unique&&(s.unique=r.unique),i=basket.require(s),0>t.inArray(r.fetch[0],window.loadedDependencies)&&window.loadedDependencies.push(r.fetch[0]),i.then(function(){r.fetch.shift(),o.getDependencies(r)},function(){o.$doc.trigger("on-loading-error",[{module:r,status:"Failed to load module"}])})},o.checkExistence=function(t){var e=!1;return void 0===t.condition?!1:e=t.condition.jquery?0!==t.condition.length:t.condition},o.setOrder=function(e){var n=t.Deferred();return e.order=e.condition.jquery?Math.floor(e.condition.offset().top):o.viewport,n.resolve(e),n.promise()},o.rejectMissingModules=function(){for(var n=t.Deferred(),r=[],i=0,u=e.length;u>i;i+=1)o.checkExistence(e[i])&&o.setOrder(e[i]).then(function(t){r.push(t)}),i===u-1&&n.resolve();return e=r,n.promise()},o.sortModules=function(){var n=t.Deferred();return e.sort(function(t,e){return t.order-e.order}),n.resolve(),n.promise()},o.setStatus=function(t){var e;t=t?t:Math.floor(100*o.loaded/o.lengthLoading),t>10&&100>t?(t=""+t,e=t.split(""),5>=e[1]?e[1]=0:(e[0]=parseInt(e[0],10)+1,e[1]=0),t=e.join("")):t>0&&10>=t&&(t=10),o.$body.attr({"data-status":t,"data-loading":o.lengthLoading,"data-loaded":o.loaded})[0].className=o.$body[0].className.replace(/on-loading-(\d){1,3}/g,"on-loading-"+t),setTimeout(function(){100===parseInt(t,10)&&(o.$body.removeClass("on-loading")[0].className=o.$body[0].className.replace("on-loading-100","on-loading-done"),o.$doc.trigger("on-loading-done"),o.promise.resolve(),setTimeout(function(){o.$body.removeClass("on-loading-done").addClass("on-loading-complete")},100))},50)},o.setLoadingValues=function(){o.loading=e.length,o.lengthLoading=e.length,o.loaded=0,o.$body.addClass("on-loading on-loading-0").attr({"data-loading":o.lengthLoading,"data-loaded":o.loaded})},o.load=function(){var t=!e.length;n&&(o.setLoadingValues(),o.setStatus(t?100:!1)),t||o.getDependencies(e[0])},o.init=function(){var t;window.loadedDependencies||(window.loadedDependencies=[]),r&&(basket.timeout=r),t=o.rejectMissingModules().then(o.sortModules),t.then(o.load)},o.init(),o.promise.promise()}})(jQuery);