(function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function e(t){return"function"==typeof t}function n(t){return"object"==typeof t&&null!==t}function r(){}function o(t,e){for(var n=0,r=t.length;r>n;n++)if(t[n]===e)return n;return-1}function i(t){var e=t._promiseCallbacks;return e||(e=t._promiseCallbacks={}),e}function u(t,e){return"onerror"===t?(be.on("error",e),void 0):2!==arguments.length?be[t]:(be[t]=e,void 0)}function s(){setTimeout(function(){for(var t,e=0;Ee.length>e;e++){t=Ee[e];var n=t.payload;n.guid=n.key+n.id,n.childGuid=n.key+n.childId,n.error&&(n.stack=n.error.stack),be.trigger(t.name,t.payload)}Ee.length=0},50)}function a(t,e,n){1===Ee.push({name:t,payload:{key:e._guidKey,id:e._id,eventName:t,detail:e._result,childId:n&&n._id,label:e._label,timeStamp:ge(),error:be["instrument-with-stack"]?Error(e._label):null}})&&s()}function c(){return new TypeError("A promises callback cannot return that same promise.")}function f(){}function l(t){try{return t.then}catch(e){return ke.error=e,ke}}function p(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function h(t,e,n){be.async(function(t){var r=!1,o=p(n,e,function(n){r||(r=!0,e!==n?y(t,n):g(t,n))},function(e){r||(r=!0,_(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,_(t,o))},t)}function v(t,e){e._state===Ae?g(t,e._result):e._state===je?(e._onError=null,_(t,e._result)):w(e,void 0,function(n){e!==n?y(t,n):g(t,n)},function(e){_(t,e)})}function d(t,n){if(n.constructor===t.constructor)v(t,n);else{var r=l(n);r===ke?_(t,ke.error):void 0===r?g(t,n):e(r)?h(t,n,r):g(t,n)}}function y(e,n){e===n?g(e,n):t(n)?d(e,n):g(e,n)}function m(t){t._onError&&t._onError(t._result),b(t)}function g(t,e){t._state===xe&&(t._result=e,t._state=Ae,0===t._subscribers.length?be.instrument&&Oe("fulfilled",t):be.async(b,t))}function _(t,e){t._state===xe&&(t._state=je,t._result=e,be.async(m,t))}function w(t,e,n,r){var o=t._subscribers,i=o.length;t._onError=null,o[i]=e,o[i+Ae]=n,o[i+je]=r,0===i&&t._state&&be.async(b,t)}function b(t){var e=t._subscribers,n=t._state;if(be.instrument&&Oe(n===Ae?"fulfilled":"rejected",t),0!==e.length){for(var r,o,i=t._result,u=0;e.length>u;u+=3)r=e[u],o=e[u+n],r?x(n,r,o,i):o(i);t._subscribers.length=0}}function E(){this.error=null}function O(t,e){try{return t(e)}catch(n){return Se.error=n,Se}}function x(t,n,r,o){var i,u,s,a,f=e(r);if(f){if(i=O(r,o),i===Se?(a=!0,u=i.error,i=null):s=!0,n===i)return _(n,c()),void 0}else i=o,s=!0;n._state!==xe||(f&&s?y(n,i):a?_(n,u):t===Ae?g(n,i):t===je&&_(n,i))}function A(t,e){var n=!1;try{e(function(e){n||(n=!0,y(t,e))},function(e){n||(n=!0,_(t,e))})}catch(r){_(t,r)}}function j(t,e,n){return t===Ae?{state:"fulfilled",value:n}:{state:"rejected",reason:n}}function k(t,e,n,r){var o=this;o._instanceConstructor=t,o.promise=new t(f,r),o._abortOnReject=n,o._validateInput(e)?(o._input=e,o.length=e.length,o._remaining=e.length,o._init(),0===o.length?g(o.promise,o._result):(o.length=o.length||0,o._enumerate(),0===o._remaining&&g(o.promise,o._result))):_(o.promise,o._validationError())}function S(t,e){return new Te(this,t,!0,e).promise}function T(t,e){function n(t){y(i,t)}function r(t){_(i,t)}var o=this,i=new o(f,e);if(!me(t))return _(i,new TypeError("You must pass an array to race.")),i;for(var u=t.length,s=0;i._state===xe&&u>s;s++)w(o.resolve(t[s]),void 0,n,r);return i}function L(t,e){var n=this;if(t&&"object"==typeof t&&t.constructor===n)return t;var r=new n(f,e);return y(r,t),r}function R(t,e){var n=this,r=new n(f,e);return _(r,t),r}function C(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function P(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function I(t,n){var r=this;r._id=Ve++,r._label=n,r._state=void 0,r._result=void 0,r._subscribers=[],be.instrument&&Oe("created",r),f!==t&&(e(t)||C(),r instanceof I||P(),A(r,t))}function V(t,e,n){this._superConstructor(t,e,!1,n)}function N(t,e){return new V(Ne,t,e).promise}function q(t,e){return Ne.all(t,e)}function M(t,e){Qe[De]=t,Qe[De+1]=e,De+=2,2===De&&Ye()}function D(){var t=process.nextTick,e=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(e)&&"0"===e[1]&&"10"===e[2]&&(t=setImmediate),function(){t(G)}}function U(){return function(){Ue(G)}}function Y(){var t=0,e=new He(G),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function J(){var t=new MessageChannel;return t.port1.onmessage=G,function(){t.port2.postMessage(0)}}function K(){return function(){setTimeout(G,1)}}function G(){for(var t=0;De>t;t+=2){var e=Qe[t],n=Qe[t+1];e(n),Qe[t]=void 0,Qe[t+1]=void 0}De=0}function H(){try{var t=require,e=t("vertx");return Ue=e.runOnLoop||e.runOnContext,U()}catch(n){return K()}}function B(t){var e={};return e.promise=new Ne(function(t,n){e.resolve=t,e.reject=n},t),e}function F(t,n,r){return Ne.all(t,r).then(function(t){if(!e(n))throw new TypeError("You must pass a function as filter's second argument.");for(var o=t.length,i=Array(o),u=0;o>u;u++)i[u]=n(t[u]);return Ne.all(i,r).then(function(e){for(var n=Array(o),r=0,i=0;o>i;i++)e[i]&&(n[r]=t[i],r++);return n.length=r,n})})}function Q(t,e,n){this._superConstructor(t,e,!0,n)}function W(t,e,n){this._superConstructor(t,e,!1,n)}function X(t,e){return new W(Ne,t,e).promise}function $(t,e){return new $e(Ne,t,e).promise}function z(t,n,r){return Ne.all(t,r).then(function(t){if(!e(n))throw new TypeError("You must pass a function as map's second argument.");for(var o=t.length,i=Array(o),u=0;o>u;u++)i[u]=n(t[u]);return Ne.all(i,r)})}function Z(){this.value=void 0}function te(t){try{return t.then}catch(e){return nn.value=e,nn}}function ee(t,e,n){try{t.apply(e,n)}catch(r){return nn.value=r,nn}}function ne(t,e){for(var n,r,o={},i=t.length,u=Array(i),s=0;i>s;s++)u[s]=t[s];for(r=0;e.length>r;r++)n=e[r],o[n]=u[r+1];return o}function re(t){for(var e=t.length,n=Array(e-1),r=1;e>r;r++)n[r-1]=t[r];return n}function oe(t,e){return{then:function(n,r){return t.call(e,n,r)}}}function ie(t,e){var n=function(){for(var n,r=this,o=arguments.length,i=Array(o+1),u=!1,s=0;o>s;++s){if(n=arguments[s],!u){if(u=ae(n),u===rn){var a=new Ne(f);return _(a,rn.value),a}u&&u!==!0&&(n=oe(u,n))}i[s]=n}var c=new Ne(f);return i[o]=function(t,n){t?_(c,t):void 0===e?y(c,n):e===!0?y(c,re(arguments)):me(e)?y(c,ne(arguments,e)):y(c,n)},u?se(c,i,t,r):ue(c,i,t,r)};return n.__proto__=t,n}function ue(t,e,n,r){var o=ee(n,r,e);return o===nn&&_(t,o.value),t}function se(t,e,n,r){return Ne.all(e).then(function(e){var o=ee(n,r,e);return o===nn&&_(t,o.value),t})}function ae(t){return t&&"object"==typeof t?t.constructor===Ne?!0:te(t):!1}function ce(t,e){return Ne.race(t,e)}function fe(t,e){return Ne.reject(t,e)}function le(t,e){return Ne.resolve(t,e)}function pe(t){throw setTimeout(function(){throw t}),t}function he(t,e){be.async(t,e)}function ve(){be.on.apply(be,arguments)}function de(){be.off.apply(be,arguments)}var ye;ye=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var me=ye,ge=Date.now||function(){return(new Date).getTime()},_e=Object.create||function(t){if(arguments.length>1)throw Error("Second argument not supported");if("object"!=typeof t)throw new TypeError("Argument must be an object");return r.prototype=t,new r},we={mixin:function(t){return t.on=this.on,t.off=this.off,t.trigger=this.trigger,t._promiseCallbacks=void 0,t},on:function(t,e){var n,r=i(this);n=r[t],n||(n=r[t]=[]),-1===o(n,e)&&n.push(e)},off:function(t,e){var n,r,u=i(this);return e?(n=u[t],r=o(n,e),-1!==r&&n.splice(r,1),void 0):(u[t]=[],void 0)},trigger:function(t,e){var n,r,o=i(this);if(n=o[t])for(var u=0;n.length>u;u++)r=n[u],r(e)}},be={instrument:!1};we.mixin(be);var Ee=[],Oe=a,xe=void 0,Ae=1,je=2,ke=new E,Se=new E,Te=k;k.prototype._validateInput=function(t){return me(t)},k.prototype._validationError=function(){return Error("Array Methods must be provided an Array")},k.prototype._init=function(){this._result=Array(this.length)},k.prototype._enumerate=function(){for(var t=this,e=t.length,n=t.promise,r=t._input,o=0;n._state===xe&&e>o;o++)t._eachEntry(r[o],o)},k.prototype._eachEntry=function(t,e){var r=this,o=r._instanceConstructor;n(t)?t.constructor===o&&t._state!==xe?(t._onError=null,r._settledAt(t._state,e,t._result)):r._willSettleAt(o.resolve(t),e):(r._remaining--,r._result[e]=r._makeResult(Ae,e,t))},k.prototype._settledAt=function(t,e,n){var r=this,o=r.promise;o._state===xe&&(r._remaining--,r._abortOnReject&&t===je?_(o,n):r._result[e]=r._makeResult(t,e,n)),0===r._remaining&&g(o,r._result)},k.prototype._makeResult=function(t,e,n){return n},k.prototype._willSettleAt=function(t,e){var n=this;w(t,void 0,function(t){n._settledAt(Ae,e,t)},function(t){n._settledAt(je,e,t)})};var Le=S,Re=T,Ce=L,Pe=R,Ie="rsvp_"+ge()+"-",Ve=0,Ne=I;I.cast=Ce,I.all=Le,I.race=Re,I.resolve=Ce,I.reject=Pe,I.prototype={constructor:I,_guidKey:Ie,_onError:function(t){be.async(function(e){setTimeout(function(){e._onError&&be.trigger("error",t)},0)},this)},then:function(t,e,n){var r=this,o=r._state;if(o===Ae&&!t||o===je&&!e)return be.instrument&&Oe("chained",r,r),r;r._onError=null;var i=new r.constructor(f,n),u=r._result;if(be.instrument&&Oe("chained",r,i),o){var s=arguments[o-1];be.async(function(){x(o,i,s,u)})}else w(r,i,t,e);return i},"catch":function(t,e){return this.then(void 0,t,e)},"finally":function(t,e){var n=this,r=n.constructor;return n.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){throw e})},e)}},V.prototype=_e(Te.prototype),V.prototype._superConstructor=Te,V.prototype._makeResult=j,V.prototype._validationError=function(){return Error("allSettled must be called with an array")};var qe=N,Me=q,De=0;({}).toString;var Ue,Ye,Je=M,Ke="undefined"!=typeof window?window:void 0,Ge=Ke||{},He=Ge.MutationObserver||Ge.WebKitMutationObserver,Be="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),Fe="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Qe=Array(1e3);Ye=Be?D():He?Y():Fe?J():void 0===Ke&&"function"==typeof require?H():K();var We=B,Xe=F,$e=Q;Q.prototype=_e(Te.prototype),Q.prototype._superConstructor=Te,Q.prototype._init=function(){this._result={}},Q.prototype._validateInput=function(t){return t&&"object"==typeof t},Q.prototype._validationError=function(){return Error("Promise.hash must be called with an object")},Q.prototype._enumerate=function(){var t=this,e=t.promise,n=t._input,r=[];for(var o in n)e._state===xe&&Object.prototype.hasOwnProperty.call(n,o)&&r.push({position:o,entry:n[o]});var i=r.length;t._remaining=i;for(var u,s=0;e._state===xe&&i>s;s++)u=r[s],t._eachEntry(u.entry,u.position)},W.prototype=_e($e.prototype),W.prototype._superConstructor=Te,W.prototype._makeResult=j,W.prototype._validationError=function(){return Error("hashSettled must be called with an object")};var ze,Ze=X,tn=$,en=z,nn=new Z,rn=new Z,on=ie;if("object"==typeof self)ze=self;else{if("object"!=typeof global)throw Error("no global: `self` or `global` found");ze=global}var un=ze,sn=ce,an=fe,cn=le,fn=pe;if(be.async=Je,"undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var ln=window.__PROMISE_INSTRUMENTATION__;u("instrument",!0);for(var pn in ln)ln.hasOwnProperty(pn)&&ve(pn,ln[pn])}var hn={race:sn,Promise:Ne,allSettled:qe,hash:tn,hashSettled:Ze,denodeify:on,on:ve,off:de,map:en,filter:Xe,resolve:cn,reject:an,all:Me,rethrow:fn,defer:We,EventTarget:we,configure:u,async:he};"function"==typeof define&&define.amd?define(function(){return hn}):"undefined"!=typeof module&&module.exports?module.exports=hn:un!==void 0&&(un.RSVP=hn)}).call(this),function(t,e){"use strict";var n=e.head||e.getElementsByTagName("head")[0],r="basket-",o=5e3,i=[],u=function(t,e){try{return localStorage.setItem(r+t,JSON.stringify(e)),!0}catch(n){if(n.name.toUpperCase().indexOf("QUOTA")>=0){var o,i=[];for(o in localStorage)0===o.indexOf(r)&&i.push(JSON.parse(localStorage[o]));return i.length?(i.sort(function(t,e){return t.stamp-e.stamp}),basket.remove(i[0].key),u(t,e)):void 0}return}},s=function(t){var e=new RSVP.Promise(function(e,n){var r=new XMLHttpRequest;r.open("GET",t),r.onreadystatechange=function(){4===r.readyState&&(200===r.status||0===r.status&&r.responseText?e({content:r.responseText,type:r.getResponseHeader("content-type")}):n(Error(r.statusText)))},setTimeout(function(){4>r.readyState&&r.abort()},basket.timeout),r.send()});return e},a=function(t){return s(t.url).then(function(e){var n=c(t,e);return t.skipCache||u(t.key,n),n})},c=function(t,e){var n=+new Date;return t.data=e.content,t.originalType=e.type,t.type=t.type||e.type,t.skipCache=t.skipCache||!1,t.stamp=n,t.expire=n+1e3*60*60*(t.expire||o),t},f=function(t,e){return!t||0>t.expire-+new Date||e.unique!==t.unique||basket.isValidItem&&!basket.isValidItem(t,e)},l=function(t){var e,n,r;if(t.url)return t.key=t.key||t.url,e=basket.get(t.key),t.execute=t.execute!==!1,r=f(e,t),t.live||r?(t.unique&&(t.url+=(t.url.indexOf("?")>0?"&":"?")+"basket-unique="+t.unique),n=a(t),t.live&&!r&&(n=n.then(function(t){return t},function(){return e}))):(e.type=t.type||e.originalType,e.execute=t.execute,n=new RSVP.Promise(function(t){t(e)})),n},p=function(t,r){var o=e.createElement(r);"style"===r?(o.setAttribute("type","text/css"),o.textContent+=t.data):o.text=t.data,o.defer=!0,n.appendChild(o)},h={"default":p},v=function(t){var e="script";return 0>t.originalType.indexOf("application/javascript")&&(e="style"),h["default"](t,e)},d=function(t){return t.map(function(t){return t.execute&&v(t),t})},y=function(){var t,e,n=[];for(t=0,e=arguments.length;e>t;t++)n.push(l(arguments[t]));return RSVP.all(n)},m=function(){var t=y.apply(null,arguments),e=this.then(function(){return t}).then(d);return e.thenRequire=m,e};t.basket={require:function(){for(var t=0,e=arguments.length;e>t;t++)arguments[t].execute=arguments[t].execute!==!1,arguments[t].once&&i.indexOf(arguments[t].url)>=0?arguments[t].execute=!1:arguments[t].execute!==!1&&0>i.indexOf(arguments[t].url)&&i.push(arguments[t].url);var n=y.apply(null,arguments).then(d);return n.thenRequire=m,n},remove:function(t){return localStorage.removeItem(r+t),this},get:function(t){var e=localStorage.getItem(r+t);try{return JSON.parse(e||"false")}catch(n){return!1}},clear:function(t){var e,n,o=+new Date;for(e in localStorage)n=e.split(r)[1],n&&(!t||o>=this.get(n).expire)&&this.remove(n);return this},isValidItem:null,timeout:5e3},basket.clear(!0)}(this,document);