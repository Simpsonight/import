(function(e){e.import=function(t,n,r){var o={loading:0,lengthLoading:0,loaded:0,body:document.getElementsByTagName("body"),defer:RSVP.defer(),loadNow:[],loadLater:[],viewport:e.innerHeight,eventEmitter:new EventEmitter};return o.finishModuleLoading=function(e){var t,n;if(e.isBool||(n=e.condition),e.callback)for(var r=0,i=e.callback.length;i>r;r+=1)e.callback[r].method&&(e.callback[r].param?e.callback[r].method.call(n,e.callback[r].param):e.callback[r].method.call(n));if(e.event&&e.event.length)for(var a=0,u=e.event.length;u>a;a+=1)t=e.event[a].data.slice()||[],o.eventEmitter.emitEvent(e.event[a].name,t);if(!e.isBool)for(var s=0,c=n.length;c>s;s+=1)"BODY"!==n[s].tagName&&(n[s].className=n[s].className.replace("on-loading",""))},o.getDependencies=function(t){var r,i=t,a={};return 0===i.fetch.length?(o.finishModuleLoading(i),o.eventEmitter.emitEvent("on-module-loaded"),o.loaded+=1,o.loading-=1,n&&o.setStatus(),undefined):(a.url=i.fetch[0],i.unique&&(a.unique=i.unique),r=basket.require(a),e.loadedDependencies.indexOf(i.fetch[0])>-1&&e.loadedDependencies.push(i.fetch[0]),r.then(function(){i.fetch.shift(),o.getDependencies(i)},function(){o.eventEmitter.emitEvent("on-loading-error",[{module:i,status:"Failed to load module"}])}),undefined)},o.processModules=function(){var e=new RSVP.Promise(function(e){for(var n,r=0,i=t.length;i>r;r+=1)n=t[r],n.isBool=!0,n.exists=!1,"string"==typeof n.condition&&n.condition?(n.condition=document.querySelectorAll(n.condition),n.exists=!!n.condition.length,n.isBool=!1):n.exists=!!n.condition,n.exists?(n.order=n.isBool?o.viewport:Math.floor(n.condition[0].offsetTop),o.loadNow.push(n)):o.loadLater.push(n),r===i-1&&e(o.loadNow)});return e},o.sortModules=function(e){var t=new RSVP.Promise(function(t){e.sort(function(e,t){return e.order-t.order}),t(e)});return t},o.getPercent=function(e){var t;return e=e?e:Math.floor(100*o.loaded/o.lengthLoading),e>10&&100>e?(e=""+e,t=e.split(""),5>=t[1]?t[1]=0:(t[0]=parseInt(t[0],10)+1,t[1]=0),e=t.join("")):e>0&&10>=e&&(e=10),e},o.setStatus=function(e){e=o.getPercent(e),o.body[0].dataset.status=e,o.body[0].dataset.loading=o.lengthLoading,o.body[0].dataset.loaded=o.loaded,o.body[0].className=o.body[0].className.replace(/on-loading-(\d){1,3}/g,"on-loading-"+e),setTimeout(function(){100===parseInt(e,10)&&(o.body[0].className=o.body[0].className.replace("on-loading ",""),o.body[0].className=o.body[0].className.replace("on-loading-100","on-loading-done"),o.eventEmitter.emitEvent("on-loading-done"),o.defer.resolve(),setTimeout(function(){o.body[0].className=o.body[0].className.replace("on-loading-done",""),o.body[0].className+=(o.body[0].className?" ":"")+"on-loading-complete"},100))},50)},o.setLoadingValues=function(){o.loading=t.length-1,o.lengthLoading=t.length-1,o.loaded=0,o.body[0].className+=(o.body[0].className?" ":"")+"on-loading on-loading-0",o.body[0].dataset.loading=o.lengthLoading,o.body[0].dataset.loaded=o.loaded},o.load=function(e){var t=!e.length;if(n&&(o.setLoadingValues(),o.setStatus(t?100:!1)),!t)for(var r=0,i=e.length;i>r;r+=1){if(!e[r].isBool)for(var a=0,u=e[r].condition.length;u>a;a+=1)"BODY"!==e[r].condition[a].tagName&&(e[r].condition[a].className+=" on-loading");o.getDependencies(e[r])}},o.init=function(){e.loadedDependencies||(e.loadedDependencies=[]),r&&(basket.timeout=r),o.processModules().then(o.sortModules).then(o.load)},o.init(),o.defer.promise}})(window);